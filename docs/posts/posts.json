[
  {
    "path": "posts/2023-11-25-graficas-con-ggplot2/",
    "title": "Introduccion a ggplot2",
    "description": "Introduccion a graficos con ggplot2.",
    "author": [
      {
        "name": "Ruddy Quispe Tapia",
        "url": {}
      }
    ],
    "date": "2023-10-22",
    "categories": [
      "articulos de opinion",
      "statistics",
      "visualization"
    ],
    "contents": "\r\n\r\nContents\r\nggplot2\r\n\r\nEste documento quiere servir de apoyo a las sesiones de Visual Analytics del Programa Big Data & Business Intelligence de la Universidad de Deusto. Como tal, es un documento en estado constante de revisión y ampliación.\r\nEstos apuntes no pretenden ser una documentación exhaustiva de ggplot2; la idea es transmitir los entresijos básicos del funcionamiento de ggplot2.\r\nggplot2\r\nggplot2 es un paquete parte de Tidyverse para crear gráficos estáticos. En los siguientes ejemplos usaremos algún otro paquete del Tidyverse, por lo que cargaremos el metapaquete entero (o<tra opción sería cargar sólo los paquetes que vayamos a usar: ggplot2, dplyr…)\r\nLayered Grammar of graphics\r\nEn 2010 Hadley Wickham publicó el artículo “A layered grammar of graphics”, basado en la Grammar of graphics de Wilkinson y en la que se basa ggplot.\r\nDicha gramática por capas consta de los siguientes elementos:\r\nDATA: ggplot espera como entrada un conjunto de datos limpio (tidy data) como entrada. Además, dependiendo del tipo de gráfica que queramos crear, tendremos que crear algún resumen de datos agregados, o incluso reestructurar el conjunto de datos original. Podemos usar conjuntos de datos distintos para capas distintas.\r\nGEOM: elemento gráfico al que se van a mapear las variables del conjunto de datos: líneas, puntos…\r\nSTATS: transformaciones estadísticas de los datos.\r\nPOSTION: ajustes para evitar que las marcas se superpongan.\r\nCOORDINATE: por defecto ggplot aplicará coordenadas cartesianas al gráfico, pero podemos modificar las escalas, así como el sistema de coordenadas (por ejemplo, a un sistema polar)\r\nFACET: para poder crear small multiples.\r\nTHEMING: funciones y argumentos relacionados con aspectos gráficos a los datos propiamente dichos: tipografía, fondo, aspecto de los ejes…\r\nCosas que hace ggplot y cosas que no\r\nggplot es una herramienta muy versátil para crear todo tipo de gráficos estáticos.\r\nAdemás es extensible, por lo que existe una comunidad de extensiones que amplian las funciones existentes en ggplot para facilitar crear determinados gráficos.\r\nSin embargo, ggplot no tiene:\r\nInteractividad: filtros… Podemos usar el paquete ggvis (en desarrollo), o montar una app con Shiny.\r\nAnimaciones. aunque están desarrollando una Grammar of animated graphics con gganimate.\r\nFuncionamiento básico\r\nCarga inicial de datos\r\nCargamos el conjunto de datos diamonds que incluye ggplot2 y echamos un vistazo a su estructura (más información sobre las variables):\r\nGráficos de Barras (Barplot)\r\nUno de los tipos de gráficos más comunes en el anállisis de datos es el gráfico de barras, en el que simplemente se representa con barras de distintas “alturas” las dimensiones de una cantidad numérica comparada con otra. Por ejemplo, tomemos como dataset inicial el mtcars, cuyos primeros valores son:\r\n\r\n                   mpg cyl disp  hp drat    wt  qsec vs am gear carb\r\nMazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\r\nMazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\r\nDatsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\r\nHornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\r\nHornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\r\nValiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1\r\n\r\nY que contiene información técnica de distintos tipos de marca y modelos de vehículos.\r\nGrafiquemos entonces el total de autos en el dataset agrupados por la cantidad de “cambios o velocidades” (columna ‘gear’):\r\n\r\n\r\n\r\n\r\n\r\n\r\nComo se observa en el ejemplo, todo gráfico hecho con ggplot debe tener un primer argumento ggplot() en donde debe especificarse cuál es el dataset que contiene la información que se desea graficar. Esta representa la primera capa que guarda la información del conjunto de datos de partida. Con el argumento data = mtcars se establece que el dataset es el indicado, y en términos de R este conjunto de datos puede ser cualquier dataframe construido o cargado previamente. Luego, se observa en el ejemplo el comando aes(), que se refiere a la “estética” del gráfico, es decir, en este caso se especifica o “mapea” cuál variable del conjunto de datos es el que se va a representar en el eje “x”. Una vez completada esta función, se agrega una segunda capa usando el operador + , y luego se establece que el gráfico a construir es de tipo barra con la función geom_bar(). Con solo esos argumentos es suficiente para producir el gráfico mostrado en el ejemplo. Ahora bien, aunque el gráfico enumera las cantidades de autos con 3, 4 y 5 velocidades que forman parte del conjunto de datos, vamos a modificar ciertas características visuales iniciales a fin de obtener un resultado final más agradable. Por ejemplo, cambiemos las etiquetas de los ejes y agregemos un título al gráfico:\r\n\r\n\r\n\r\nObsérvese que esto se logra agregrando capas con el operador + , e incorporando los elementos deseados. El gráfico luce mucho mejor, pero tal vez el color gris por defecto no resulta muy atractivo. Si lo deseamos, podemos cambiar el color con el que se representan tanto el área interior de las barras, como su borde, colocando explícitamente los valores dentro de la función geom_bar():\r\n\r\n\r\n\r\nComo referencia para los nombres de los colores usados, recomiendo revisar el siguiente link.\r\nY si el gráfico lo amerita, podemos también cambiar la orientación de los ejes haciendo uso de la función coord_flip():\r\n\r\n\r\n\r\nAhora bien, si deseamos que cada grupo de datos (velocidades, en este caso) tenga colores distintos, basta con asignar, dentro de la “estética”, el color como parámetro, y mapearlo a alguna variable. En este caso, al propio valor de “gear”, pero dicho valor debe ser convertido antes a una variable tipo factor, es decir, una variable categórica:\r\n\r\n\r\n\r\nEn este caso, se introdujo la función labs(fill = … ) para cambiar el título de la leyenda. De lo contrario, en dicha leyenda aparecería as.factor(gear).\r\nSi queremos, adicionalmente, cambiar el estilo del fondo, podemos hacerlo seleccionando el “tema” de visualización de la siguiente manera:\r\n\r\n\r\n\r\nPor último (y esto es aplicable a cualquier otro gráfico que mostremos a lo largo de todo el ejercicio práctico), es importante mencionar que cualquier indicación de parámetros (por ejemplo, la “estética”) que coloquemos en la función ggplot(), será sobreescrita si modificamos los argumentos de la función geom_… posterior. Es decir, veamos el siguiente ejemplo:\r\n\r\n\r\n\r\nComo puede observarse, aún cuando en la primera función se estableció el relleno de las barras en función de los valores de la variable ‘gear’, al fijar el color y el relleno de nuevo en la función geom_bar() se tomará esta última como aquella a aplicar al gráfico.\r\n\r\n\r\n\r\n",
    "preview": "posts/2023-11-25-graficas-con-ggplot2/graficas-con-ggplot2_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2023-11-25T21:00:32-04:00",
    "input_file": {}
  }
]
